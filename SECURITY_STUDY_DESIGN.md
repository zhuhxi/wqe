# 信息安全考试题目设计与理解文档

本文档按你给出的复习路径组织：先“模型与对比题”，再“流程题”，最后“设计题”。
目标不是死记，而是让你能快速写出考试答案。

## 0. 使用方式

- 第 1 遍：先看每节的“速记句”。
- 第 2 遍：做每节样题，口述答案。
- 第 3 遍：套用最后的“设计题模板”，自己出 1 题并答题。

---

## 1. 模型与对比题

### 1.1 BLP vs Biba

#### 核心定位
- BLP（Bell-LaPadula）: 保密性模型。
- Biba: 完整性模型。

#### 速记句
- BLP: `不上读，不下写`（No Read Up, No Write Down）。
- Biba: `不下读，不上写`（No Read Down, No Write Up）。

#### 对比表

| 维度 | BLP | Biba |
|---|---|---|
| 保护目标 | 机密性（Confidentiality） | 完整性（Integrity） |
| 读规则 | 不可向上读 | 不可向下读 |
| 写规则 | 不可向下写 | 不可向上写 |
| 典型场景 | 军事分级保密 | 财务系统防篡改 |

#### 高频易错
- 把 BLP 和 Biba 的读写方向写反。
- 把“保密”与“完整性”目标混淆。

#### 样题
题目：解释 BLP 与 Biba 的核心差异，并分别给出一个应用场景。

参考答题骨架：
- BLP 关注保密性，核心是防止高密级信息泄漏到低密级。
- Biba 关注完整性，核心是防止低可信数据污染高可信对象。
- 场景：BLP 用于涉密文档访问控制，Biba 用于审计/财务记账系统。

---

### 1.2 AH vs ESP（IPsec）

#### 核心定位
- AH（Authentication Header）: 认证 + 完整性校验 + 抗重放，不提供加密。
- ESP（Encapsulating Security Payload）: 可提供机密性（加密）+ 完整性 + 认证。

#### 速记句
- AH 看得见内容（不加密）。
- ESP 能“包起来”（可加密载荷）。

#### 对比表

| 维度 | AH | ESP |
|---|---|---|
| 机密性 | 无 | 有（常用） |
| 完整性/认证 | 有 | 有 |
| NAT 兼容性 | 较差（头部变动影响校验） | 较好（常见 NAT-T） |
| 实战使用 | 较少 | 主流 |

#### 高频易错
- 说 AH 有加密功能（错误）。
- 忽略 NAT 场景下 AH 的限制。

#### 样题
题目：企业分支互联走公网，为什么通常选 ESP 而不是 AH？

参考答题骨架：
- ESP 提供数据机密性，满足公网传输的保密需求。
- ESP 在 NAT 场景兼容更好，部署更常见。
- AH 不加密，且 NAT 场景受限。

---

### 1.3 HIDS vs NIDS

#### 核心定位
- HIDS（Host IDS）: 监控主机级日志、文件、进程、系统调用。
- NIDS（Network IDS）: 监控网络流量与报文行为。

#### 速记句
- HIDS 看“机内行为”。
- NIDS 看“线上流量”。

#### 对比表

| 维度 | HIDS | NIDS |
|---|---|---|
| 部署位置 | 主机/服务器 | 交换机镜像口/网络出口 |
| 可见性 | 主机细粒度 | 网络全局态势 |
| 对加密流量 | 可看解密后主机行为 | 加密后内容可见性差 |
| 性能影响 | 消耗主机资源 | 消耗探针/分析设备资源 |

#### 高频易错
- 认为 NIDS 能完全替代 HIDS。
- 忽略加密流量对 NIDS 的影响。

#### 样题
题目：在 HTTPS 全面普及后，为什么仍需要 HIDS？

参考答题骨架：
- NIDS 对加密后的应用层内容可见性下降。
- HIDS 能看到主机侧落地行为（文件篡改、异常进程、提权痕迹）。
- 两者联动可提升检测覆盖面。

---

### 1.4 SSL vs VPN

#### 核心定位
- SSL/TLS: 保护应用会话（如 HTTPS）。
- VPN: 保护网络隧道（站点到站点/远程接入）。

#### 速记句
- SSL 保护“应用连接”。
- VPN 保护“网络路径”。

#### 对比表

| 维度 | SSL/TLS | VPN |
|---|---|---|
| 作用层次 | 传输层以上（常见应用接入） | 网络层/链路隧道 |
| 保护范围 | 单应用或单会话 | 整段网段流量 |
| 常见形式 | HTTPS、TLS 加密服务 | IPsec VPN、SSL VPN |
| 典型用途 | Web 安全访问 | 异地组网、远程办公全局访问 |

#### 高频易错
- 把 SSL 和 SSL VPN 混成一个概念。
- 说“用了 HTTPS 就不需要 VPN”（取决于是否要保护全网访问）。

#### 样题
题目：远程员工要访问企业多个内网系统，优先选 TLS 代理还是 VPN？为什么？

参考答题骨架：
- 若需访问多个内网网段和多协议资源，优先 VPN。
- 若仅访问单一 Web 系统，可用 TLS/反向代理方式。
- 选择取决于访问范围、终端管控和最小权限策略。

---

## 2. 流程题

### 2.1 CHAP 认证流程

#### 流程
1. 认证方发送 Challenge（随机数）。
2. 被认证方用 `Hash(随机数 + 共享密钥)` 计算响应。
3. 被认证方发送 Response。
4. 认证方用同样方式计算并比对。
5. 一致则通过，否则失败。

#### 关键理解
- 明文口令不在链路上传输。
- 安全性依赖共享密钥强度与随机数质量。

#### 易考点
- CHAP 是挑战-应答，不是证书体系。
- 可周期性重新认证，降低重放风险。

---

### 2.2 SSL/TLS 握手（以 TLS 1.2 经典表述为主）

#### 流程
1. ClientHello: 客户端发支持的版本、套件、随机数。
2. ServerHello: 服务器选择版本、套件并返回随机数。
3. 服务器发证书（必要时含密钥交换参数）。
4. 客户端验证证书链与域名。
5. 客户端产生预主密钥并安全发送。
6. 双方推导会话密钥。
7. ChangeCipherSpec + Finished，握手完成。

#### 关键理解
- 证书解决“你是谁”（身份认证）。
- 会话密钥解决“传输加密性能”（对称加密）。

#### 易考点
- 非对称加密常用于握手阶段，数据面多用对称加密。
- 若证书校验失败，连接应终止。

---

### 2.3 Kerberos 流程

#### 角色
- Client: 用户端。
- AS: 认证服务器。
- TGS: 票据授权服务器。
- Service Server: 业务服务。

#### 流程
1. Client 向 AS 请求 TGT。
2. AS 返回 `TGT + 与用户口令相关密钥加密的信息`。
3. Client 使用 TGT 向 TGS 请求服务票据。
4. TGS 返回 Service Ticket。
5. Client 持 Service Ticket 访问目标服务。
6. 服务端验证票据后授权访问。

#### 关键理解
- 核心是“票据”机制，避免反复发送口令。
- 依赖时间同步，时钟偏差过大可能认证失败。

#### 易考点
- 区分 TGT 与 Service Ticket 的用途。
- Kerberos 是集中认证，不等于 SSO 的全部实现细节。

---

### 2.4 IKE 两阶段（以 IKEv1 常见考试口径）

#### 阶段 1（建立 IKE SA）
1. 双方协商算法与参数。
2. 认证身份（预共享密钥/证书等）。
3. 建立安全的管理信道（IKE SA）。

#### 阶段 2（建立 IPsec SA）
1. 在 IKE SA 保护下协商 IPsec 参数。
2. 生成用于业务数据传输的 SA（单向）。
3. 后续数据按 SA 用 AH/ESP 保护。

#### 关键理解
- 第一阶段先搭“安全谈判通道”，第二阶段再谈“业务通道”。
- IPsec SA 通常成对出现（入向/出向）。

#### 易考点
- 混淆 IKE SA 和 IPsec SA。
- 忽略生命周期与重协商。

---

## 3. 设计题（重点）

### 3.1 防火墙规则设计模板

#### 步骤
1. 资产与区域划分：Internet、DMZ、内网办公区、服务器区、运维区。
2. 业务流梳理：谁访问谁、用什么协议端口、是否双向。
3. 策略编写顺序：先放行必要流量，再默认拒绝（deny all）。
4. 安全增强：源地址限制、时间策略、日志审计、规则去冗余。

#### 规则样例（文字版）
- 允许 Internet -> DMZ Web：TCP 443。
- 允许 DMZ Web -> 内网 App：TCP 8443（仅指定主机）。
- 允许 App -> DB：TCP 3306（最小源/目的集合）。
- 拒绝 Internet -> 内网任意访问。
- 默认拒绝并记录日志。

#### 评分抓手
- 是否体现最小权限。
- 是否有默认拒绝。
- 是否控制横向移动路径。

---

### 3.2 DMZ 架构设计模板

#### 典型三层区
- 外网区（Untrusted）。
- DMZ 区（对外服务区，如 WAF/反向代理/Web）。
- 内网区（业务与数据库）。

#### 核心原则
- 外网不能直达内网。
- 对外服务放 DMZ，核心数据留内网。
- 跨区访问必须经过明确策略与审计。

#### 参考拓扑（文本）
`Internet -> 边界防火墙 -> DMZ(Web/WAF) -> 内网防火墙 -> App/DB`

#### 评分抓手
- 分区是否清晰。
- 是否有双边界控制（至少逻辑隔离）。
- 是否考虑入侵后的横向隔离。

---

### 3.3 网络加固措施模板

#### 主机侧
- 关闭不必要端口与服务。
- 最小权限账户、禁用共享高权账号。
- 补丁管理与基线核查。
- EDR/HIDS 部署与日志留存。

#### 网络侧
- VLAN/ACL 分段，限制横向访问。
- 出口最小放行，DNS/代理统一管控。
- IDS/IPS + 流量审计。
- 关键链路加密（IPsec/TLS）。

#### 管理侧
- 运维双因素认证。
- 堡垒机与命令审计。
- 备份与恢复演练。
- 应急响应预案与演练。

#### 评分抓手
- 是否覆盖“人、机、网、管”。
- 是否可执行（不是空泛口号）。

---

## 4. 综合设计题示例（可直接练）

### 题目
某企业需要对外提供网站服务，内部有应用服务器和数据库服务器。要求：
- 外网用户可访问网站。
- 数据库不得被外网直接访问。
- 运维人员可远程维护系统。
- 发生攻击时可追溯。

请设计网络安全方案（区域划分、防火墙策略、认证与加固措施）。

### 参考答案结构

#### 1) 区域划分
- Internet 区。
- DMZ 区：WAF/反向代理/Web。
- 内网业务区：App、DB。
- 运维管理区：堡垒机、日志平台。

#### 2) 关键访问路径
- Internet -> WAF/Web: TCP 443。
- Web -> App: 仅业务端口（如 8443）。
- App -> DB: 仅 DB 端口（如 3306）。
- 运维 -> 堡垒机 -> 目标主机: SSH/RDP，禁止直连。

#### 3) 防火墙与 ACL 策略
- 明确允许上述必要流量。
- 拒绝 Internet 直达内网。
- 拒绝 DMZ 到 DB 的非必要端口。
- 默认拒绝并全量记录关键拒绝日志。

#### 4) 认证与加密
- 运维登录启用 MFA。
- 管理平面启用 TLS/IPsec。
- 对外证书由可信 CA 签发并定期轮换。

#### 5) 监测与审计
- DMZ 与内网边界部署 NIDS。
- 关键主机部署 HIDS/EDR。
- 集中日志（防火墙、系统、应用、WAF）关联分析。

#### 6) 加固与运维
- 周期补丁更新、弱口令治理、最小权限。
- 配置备份与恢复演练。
- 建立事件分级响应流程。

---

## 5. 考场速写模板（最后背这个）

### 对比题 4 句模板
1. 先写两者目标差异。  
2. 再写关键机制差异。  
3. 给一个典型应用场景。  
4. 补一句常见误区。  

### 流程题 5 步模板
1. 发起方。  
2. 参数协商/挑战。  
3. 身份校验。  
4. 会话密钥/票据建立。  
5. 安全通信与复核机制。  

### 设计题 6 点模板
1. 分区。  
2. 业务流。  
3. 访问控制规则。  
4. 认证与加密。  
5. 监测审计。  
6. 加固与应急。  

按此写法，答案结构完整、评分点覆盖高。
